---
{"dg-publish":true,"dg-home":false,"permalink":"/pentesting-roots/pentesting-franklyn/","dgPassFrontmatter":true,"created":"2024-02-07T21:20:16.320-06:00"}
---













![Pasted image 20240206224606.png](/img/user/Pasted%20image%2020240206224606.png)
# WordPress 6.4.2 


![[Pasted image 20240206224759.png \| 1000]] 

![[Pasted image 20240206224854.png \| 1000]]

El sitio web "[www.romeropineda.com](http://www.romeropineda.com/)" utiliza un tema de WordPress llamado "halstein" en su diseño. La versión del tema es "6.4.2". Se cargan archivos CSS y JavaScript del tema desde la carpeta correspondiente en el servidor del sitio web. Los archivos CSS incluyen "main.min.css" y "grid.min.css", mientras que el archivo JavaScript se llama "main.min.js".


[+] WordPress version 6.4.2 identified (Insecure, released on 2023-12-06).
 | Found By: Rss Generator (Passive Detection)
 |  - https://www.romeropineda.com/feed/, <generator>https://wordpress.org/?v=6.4.2</generator>
 |  - https://www.romeropineda.com/comments/feed/, <generator>https://wordpress.org/?v=6.4.2</generator>
 |
 | [!] 2 vulnerabilities identified:
 |
 | [!] Title: WordPress < 6.4.3 - Deserialization of Untrusted Data
 |     Fixed in: 6.4.3
 |     References:
 |      - https://wpscan.com/vulnerability/5e9804e5-bbd4-4836-a5f0-b4388cc39225
 |      - https://wordpress.org/news/2024/01/wordpress-6-4-3-maintenance-and-security-release/
 |
 | [!] Title: WordPress < 6.4.3 - Admin+ PHP File Upload
 |     Fixed in: 6.4.3
 |     References:
 |      - https://wpscan.com/vulnerability/a8e12fbe-c70b-4078-9015-cf57a05bdd4a
 |      - https://wordpress.org/news/2024/01/wordpress-6-4-3-maintenance-and-security-release/



Los plugins encontrados en el sitio web "[www.romeropineda.com](http://www.romeropineda.com/)" son:

![Pasted image 20240206224212.png](/img/user/Pasted%20image%2020240206224212.png)
wp-content/plugins/cf7-multi-step
wp-content/plugins/contact-form-7
wp-content/plugins/custom-twitter-feeds
wp-content/plugins/elementor
wp-content/plugins/elementor-pro
wp-content/plugins/elementskit-lite
wp-content/plugins/halstein-core
wp-content/plugins/instagram-feed
wp-content/plugins/qi-addons-for-elementor
wp-content/plugins/qi-blocks
wp-content/plugins/relevanssi-live-ajax-search
wp-content/plugins/revslider
wp-content/plugins/team-showcase-supreme
wp-content/plugins/translatepress-multilingual
# Vulnerabilidades encontradas en 4 plugins  

![Pasted image 20240206225008.png](/img/user/Pasted%20image%2020240206225008.png)
| [!] 4 vulnerabilities identified:
 |
 | [!] Title: Revolution Slider <= 6.6.12 - Author+ Remote Code Execution
 |     Fixed in: 6.6.13
 |     References:
 |      - https://wpscan.com/vulnerability/a8350890-e6d4-4b04-a158-2b0ee3748e65
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2359
 |
 | [!] Title: Slider Revolution < 6.6.15 - Authenticated (Contributor+) Stored Cross-Site Scripting
 |     Fixed in: 6.6.15
 |     References:
 |      - https://wpscan.com/vulnerability/3cde24f3-aaad-4eb3-b6ba-a518afe66fbe
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-47772
 |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/772e843b-00ea-45f5-b730-c9a793d4c2db
 |
 | [!] Title: Slider Revolution < 6.6.16 - Authenticated (Author+) Arbitrary File Upload
 |     Fixed in: 6.6.16
 |     References:
 |      - https://wpscan.com/vulnerability/1b841a64-fb0a-434f-b7b4-0777f0480c87
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-47784
 |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/e2d29afd-06e8-461a-918f-38228441a51a
 |
 | [!] Title: Slider Revolution < 6.6.19 - Author+ Insecure Deserialization leading to RCE
 |     Fixed in: 6.6.19
 |     References:
 |      - https://wpscan.com/vulnerability/36ced447-84ea-4162-80d2-6df226cb53cb
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6528



# Usuarios identificados


![Pasted image 20240206225314.png](/img/user/Pasted%20image%2020240206225314.png)


|Usuarios|Contraseña|
|---|---|
|gcestoni| |
|dev||
|Diaz||
|[mvillegas@solucionesroots.com  ](mailto:mvillegas@solucionesroots.com) ||
|[oscar@romeropineda.com](mailto:oscar@romeropineda.com)||
|ROMEROPINEDA||
|Geraldina Cestoni||
|||


--------------------------------------------------------------------

![[Pasted image 20240206234301.png \| ]]
`https://www.romeropineda.com`:

- **Target IP:** 162.240.71.37
- **Target Hostname:** [www.romeropineda.com](http://www.romeropineda.com/)
- **Target Port:** 443 (SSL)

### Detalles de SSL:

- **Sujeto:** /CN=romeropineda.com
- **Altnames:** romeropineda.com, mail.romeropineda.com, [www.romeropineda.com](http://www.romeropineda.com/)
- **Cifras:** ECDHE-RSA-AES256-GCM-SHA384
- **Emisor:** /C=US/ST=TX/L=Houston/O=cPanel, Inc./CN=cPanel, Inc. Certification Authority
- **Hora de inicio:** 2024-02-06 08:57:23 (GMT-6)

### Información del servidor:

- **Servidor:** Apache

### Vulnerabilidades detectadas:

1. **Anti-clickjacking X-Frame-Options header no presente:** Este encabezado ayuda a prevenir ataques de secuestro de clics al especificar que un sitio web solo puede ser cargado dentro de un marco específico. Sin este encabezado, el sitio puede ser vulnerable a ataques de clickjacking. [Más información](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options).
    
2. **Drupal Link header encontrado:** Se ha detectado un encabezado de enlace de Drupal que especifica relaciones de enlace para recursos relacionados con WordPress. Esto puede proporcionar información adicional sobre la estructura y los recursos del sitio, lo que podría ser útil para un posible atacante. [Más información](https://www.drupal.org/).
    
3. **Strict-Transport-Security HTTP header no definido:** Este encabezado ayuda a proteger a los usuarios contra ataques de intermediarios, especificando que el navegador solo debe cargar el sitio web a través de conexiones HTTPS. Sin este encabezado, el sitio puede ser vulnerable a ataques de intermediarios. [Más información](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security).
    
4. **X-Content-Type-Options header no configurado:** Este encabezado ayuda a proteger contra ataques de tipo de contenido incorrecto al forzar al navegador a respetar el tipo de contenido declarado en la respuesta HTTP. Sin este encabezado, el sitio puede ser vulnerable a ciertos tipos de ataques. [Más información](https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/).
    
5. **Encabezado x-redirect-by no común:** Se ha encontrado un encabezado inusual 'x-redirect-by' con el contenido 'WordPress'. Este encabezado puede proporcionar información adicional sobre el servidor y el sistema utilizado, lo que podría ser útil para un posible atacante.
    
6. **robots.txt contiene 2 entradas:** El archivo robots.txt contiene 2 entradas que deben ser revisadas manualmente. El archivo robots.txt se utiliza para controlar el comportamiento de los motores de búsqueda y rastreadores web en el sitio. [Más información](https://developer.mozilla.org/en-US/docs/Glossary/Robots.txt).
    

Estos resultados proporcionan información sobre las posibles vulnerabilidades y configuraciones de seguridad que pueden estar presentes en el sitio web `https://www.romeropineda.com`.


--------------------------------------------------------------------

# OWASP ZAP

Hemos escaneado con OWASP ZAP a 2 dominios la web principal y la vieja

[www.romeropineda.com](http://www.romeropineda.com/)

![Pasted image 20240207173559.png](/img/user/Pasted%20image%2020240207173559.png)

La primera bandera es de riesgo medio ya que es de CSRF (Cross-Site Request Forgery) es un tipo de ataque informático en el que un atacante aprovecha la confianza que un sitio web tiene en un usuario autenticado para realizar acciones no deseadas en su nombre sin que el usuario sea consciente de ello. Esto puede incluir acciones maliciosas como cambiar la contraseña, enviar mensajes o realizar compras sin autorización.

Los ataques CSRF son efectivos en varias situaciones, incluyendo:

- La víctima tiene una sesión activa en el sitio objetivo.
- La víctima está autenticada a través de HTTP auth en el sitio objetivo.
- La víctima está en la misma red local que el sitio objetivo.

[http://smilegroup.romeropineda.com](http://smilegroup.romeropineda.com/)

![Pasted image 20240207174723.png](/img/user/Pasted%20image%2020240207174723.png)
Se ha establecido una cookie sin el indicador HttpOnly, lo que significa que la cookie puede ser accedida por JavaScript. Si se ejecuta un script malicioso en esta página, la cookie será accesible y puede ser transmitida a otro sitio. Si esta es una cookie de sesión, puede ser posible el secuestro de sesión.


____________

# Respaldo de DB encontrada

https://www.romeropineda.com/wp-content/uploads/romeropi_wp122023_wp_.sql


# [Usuario: romeropi_wp122023
 
# [contraseña: bf#2zX)i?VK

__________________________________________________

# Web Antigua 

(smilegroup.romeropineda.com)



![Pasted image 20240207135716.png](/img/user/Pasted%20image%2020240207135716.png)
-------------------------------------------------------
# La comunicación remota Activada



![Pasted image 20240207141356.png](/img/user/Pasted%20image%2020240207141356.png)


![Pasted image 20240207142037.png](/img/user/Pasted%20image%2020240207142037.png)



![Pasted image 20240207142727.png](/img/user/Pasted%20image%2020240207142727.png)
![Pasted image 20240207142820.png](/img/user/Pasted%20image%2020240207142820.png)

La activación de la comunicación remota puede ser vulnerable si no se gestiona adecuadamente. 

#Algunos de los riesgos y vulnerabilidades asociados incluyen:

1. **Exposición a ataques de fuerza bruta**: Los servicios de comunicación remota, como SSH o RDP, pueden estar expuestos a ataques de fuerza bruta donde los atacantes intentan adivinar credenciales de acceso mediante la prueba de combinaciones de nombres de usuario y contraseñas.
    
2. **Vulnerabilidades de software**: Los servicios remotos pueden tener vulnerabilidades de software conocidas o desconocidas que podrían ser explotadas por atacantes para comprometer el sistema. Estas vulnerabilidades pueden incluir errores de programación, debilidades en la autenticación, desbordamientos de búfer, entre otros.
    
3. **Exposición de credenciales**: Si las credenciales de acceso (como contraseñas o claves SSH) se manejan de manera insegura o se comparten inadvertidamente, podrían ser interceptadas por atacantes y utilizadas para acceder de manera no autorizada al sistema.
    
4. **Acceso no autorizado**: La configuración incorrecta de los controles de acceso remoto podría permitir el acceso no autorizado a recursos sensibles o críticos del sistema, lo que podría conducir a la pérdida de datos, la interrupción del servicio o el compromiso de la integridad del sistema.
    
5. **Intercepción de datos**: Si la comunicación remota no se cifra adecuadamente, los datos transmitidos entre el cliente y el servidor podrían ser interceptados por atacantes, comprometiendo la confidencialidad de la información transmitida.
    
6. **Ataques de denegación de servicio (DoS)**: Los servicios remotos podrían ser objeto de ataques de denegación de servicio que intentan abrumar el sistema con tráfico malicioso, lo que resulta en la interrupción del servicio para usuarios legítimos.


Referencia.
https://github.com/kh4sh3i/xmlrpc-exploit?tab=readme-ov-file#xml-rpc-pingbacks-attacks


_______________________________________________________

# WP-admin no esta ofuscado 



![Pasted image 20240207141734.png](/img/user/Pasted%20image%2020240207141734.png)
_______________________________________________________

# Correos encontrados, "mismos usuarios encontrados"

# oscar@romeropineda.com

# mvillegas@solucionesroots.com 



_______________________________________________________
# Se encontró, un dominio indexado con un servidor apache corriendo.

https://solucionesroot.romeropineda.com/

![Pasted image 20240207151733.png](/img/user/Pasted%20image%2020240207151733.png)}

---
![Pasted image 20240207214639.png](/img/user/Pasted%20image%2020240207214639.png) 
se hizo un es caneo de ambos correos escaneados y se encontró sitios de dudosa procedencia donde estaban registrados, sobre todo el primero.
_______________________

# Servidor Econtrado




![Pasted image 20240207083848.png](/img/user/Pasted%20image%2020240207083848.png)
Server: 192.168.157.2  
Address: 192.168.157.2#53 "web"

Non-authoritative answer:  
Name: [www.romeropineda.com](http://www.romeropineda.com/)  
Address: 162.240.71.37

# General_Information

#Hostnames

# [https://162.240.71.37:2083](https://162.240.71.37:2083/) Cpanel en el servidor donde esta la web


![Pasted image 20240207133552.png](/img/user/Pasted%20image%2020240207133552.png)

|Dominios|IP|
|---|---|
|ns2.romeropineda.com|162.240.71.37|
|ns1.romeropineda.com|162.240.71.37|
|romeropineda.com|162.240.71.37|
|autodiscover.rom1.romeropineda.com|162.240.71.37|
|cpanel.rom1.romeropineda.com|162.240.71.37|
|[www.5838503.romeropineda.com](http://www.5838503.romeropineda.com/)|162.240.71.37|
|[www.romeropineda.com](http://www.romeropineda.com/)|162.240.71.37|
|webmail.rom1.romeropineda.com|162.240.71.37|
|webdisk.rom1.romeropineda.com|162.240.71.37|
|mail.rom1.romeropineda.com|162.240.71.37|
|rom1.romeropineda.com|162.240.71.37|
|mail.romeropineda.com|162.240.71.37|
|5838503.romeropineda.com|162.240.71.37|
|mail.5838503.romeropineda.com|162.240.71.37|
|[www.rom1.romeropineda.com](http://www.rom1.romeropineda.com/)|162.240.71.37|
|[smilegroup.romeropineda.com "Web vieja"]|162.240.71.37|

```
puertos abiertos:  22, 26, 53, 80, 110, 143, 443, 465, 587, 993, 995, 2082, 2083,         2086, 2087 



```


![Pasted image 20240206215904.png](/img/user/Pasted%20image%2020240206215904.png)

---

# 

Los escaneos revelaron el servicio de SSH activos y con su respectiva versión.

Posible uso de Sploit para posibles ataques

![Pasted image 20240207103254.png](/img/user/Pasted%20image%2020240207103254.png)
---

# _Vulnerabilities_


![[Pasted image 20240207103021.png \| 1000]]


|   |   |
|---|---|
|[CVE-2023-51385](https://www.shodan.io/search?query=vuln%3ACVE-2023-51385)|In ssh in OpenSSH before 9.6, OS command injection might occur if a user name or host name has shell metacharacters, and this name is referenced by an expansion token in certain situations. For example, an untrus.io/search?query=vuln%3ACVE-2023-51384)|In ssh-agent in OpenSSH before 9.6, certain destination constraints can be incompletely applied. When destination constraints are specified during addition of PKCS#11-hosted private keys, these constraints are only applied to the first key, even if a PKCS#11 token returns multiple keys.|
|[CVE-2023-48795](https://www.shodan.io/search?query=vuln%3ACVE-2023-48795)|The SSH transport protocol with certain OpenSSH extensions, found in OpenSSH before 9.6 and other products, allows remote attackers to bypass integrity checks such that some packets are omitted (from the extension negotiation message), and a client and server may consequently end up with a connection for which some security features have been downgraded or disabled, aka a Terrapin attack. This occurs because the SSH Binary Packet Protocol (BPP), implemented by these extensions, mishandles the handshake phase and mishandles use of sequence numbers. For example, there is an effective attack against SSH's use of ChaCha20-Poly1305 (and CBC with Encrypt-then-MAC). The bypass occurs in chacha20-poly1305@openssh.com and (if CBC is used) the -etm@openssh.com MAC algorithms. This also affects Maverick Synergy Java SSH API before 3.1.0-SNAPSHOT, Dropbear through 2022.83, Ssh before 5.1.1 in Erlang/OTP, PuTTY before 0.80, AsyncSSH before 2.14.2, golang.org/x/crypto before 0.17.0, libssh before 0.10.6, libssh2 through 1.11.0, Thorn Tech SFTP Gateway before 3.4.6, Tera Term before 5.1, Paramiko before 3.4.0, jsch before 0.2.15, SFTPGo before 2.5.6, Netgate pfSense Plus through 23.09.1, Netgate pfSense CE through 2.7.2, HPN-SSH through 18.2.0, ProFTPD before 1.3.8b (and before 1.3.9rc2), ORYX CycloneSSH before 2.3.4, NetSarang XShell 7 before Build 0144, CrushFTP before 10.6.0, ConnectBot SSH library before 2.2.22, Apache MINA sshd through 2.11.0, sshj through 0.37.0, TinySSH through 20230101, trilead-ssh2 6401, LANCOM LCOS and LANconfig, FileZilla before 3.66.4, Nova before 11.8, PKIX-SSH before 14.4, SecureCRT before 9.4.3, Transmit5 before 5.10.4, Win32-OpenSSH before 9.5.0.0p1-Beta, WinSCP before 6.2.2, Bitvise SSH Server before 9.32, Bitvise SSH Client before 9.33, KiTTY through 0.76.1.13, the net-ssh gem 7.2.0 for Ruby, the mscdex ssh2 module before 1.15.0 for Node.js, the thrussh library before 0.35.1 for Rust, and the Russh crate before 0.40.2 for Rust.|
|[CVE-2023-38408](https://www.shodan.io/search?query=vuln%3ACVE-2023-38408)|The PKCS#11 feature in ssh-agent in OpenSSH before 9.3p2 has an insufficiently trustworthy search path, leading to remote code execution if an agent is forwarded to an attacker-controlled system. (Code in /usr/lib is not necessarily safe for loading into ssh-agent.) NOTE: this issue exists because of an incomplete fix for CVE-2016-10009.|
|[CVE-2021-41617](https://www.shodan.io/search?query=vuln%3ACVE-2021-41617)|4.4sshd in OpenSSH 6.2 through 8.x before 8.8, when certain non-default configurations are used, allows privilege escalation because supplemental groups are not initialized as expected. Helper programs for AuthorizedKeysCommand and AuthorizedPrincipalsCommand may run with privileges associated with group memberships of the sshd process, if the configuration specifies running the command as a different user.|
|[CVE-2021-36368](https://www.shodan.io/search?query=vuln%3ACVE-2021-36368)|2.6** DISPUTED ** An issue was discovered in OpenSSH before 8.9. If a client is using public-key authentication with agent forwarding but without -oLogLevel=verbose, and an attacker has silently modified the server to support the None authentication option, then the user cannot determine whether FIDO authentication is going to confirm that the user wishes to connect to that server, or that the user wishes to allow that server to connect to a different server on the user's behalf. NOTE: the vendor's position is "this is not an authentication bypass, since nothing is being bypassed."|
|[CVE-2020-15778](https://www.shodan.io/search?query=vuln%3ACVE-2020-15778)|6.8** DISPUTED ** scp in OpenSSH through 8.3p1 allows command injection in the scp.c toremote function, as demonstrated by backtick characters in the destination argument. NOTE: the vendor reportedly has stated that they intentionally omit validation of "anomalous argument transfers" because that could "stand a great chance of breaking existing workflows."|
|[CVE-2020-14145](https://www.shodan.io/search?query=vuln%3ACVE-2020-14145)|4.3The client side in OpenSSH 5.7 through 8.4 has an Observable Discrepancy leading to an information leak in the algorithm negotiation. This allows man-in-the-middle attackers to target initial connection attempts (where no host key for the server has been cached by the client). NOTE: some reports state that 8.5 and 8.6 are also affected.|
|[CVE-2019-6111](https://www.shodan.io/search?query=vuln%3ACVE-2019-6111)|5.8An issue was discovered in OpenSSH 7.9. Due to the scp implementation being derived from 1983 rcp, the server chooses which files/directories are sent to the client. However, the scp client only performs cursory validation of the object name returned (only directory traversal attacks are prevented). A malicious scp server (or Man-in-The-Middle attacker) can overwrite arbitrary files in the scp client target directory. If recursive operation (-r) is performed, the server can manipulate subdirectories as well (for example, to overwrite the .ssh/authorized_keys file).|
|[CVE-2019-6110](https://www.shodan.io/search?query=vuln%3ACVE-2019-6110)|4.0In OpenSSH 7.9, due to accepting and displaying arbitrary stderr output from the server, a malicious server (or Man-in-The-Middle attacker) can manipulate the client output, for example to use ANSI control codes to hide additional files being transferred.|
|[CVE-2019-6109](https://www.shodan.io/search?query=vuln%3ACVE-2019-6109)|4.0An issue was discovered in OpenSSH 7.9. Due to missing character encoding in the progress display, a malicious server (or Man-in-The-Middle attacker) can employ crafted object names to manipulate the client output, e.g., by using ANSI control codes to hide additional files being transferred. This affects refresh_progress_meter() in progressmeter.c.|
|[CVE-2018-20685](https://www.shodan.io/search?query=vuln%3ACVE-2018-20685)|2.6In OpenSSH 7.9, scp.c in the scp client allows remote SSH servers to bypass intended access restrictions via the filename of . or an empty filename. The impact is modifying the permissions of the target directory on the client side.|
|[CVE-2018-15919](https://www.shodan.io/search?query=vuln%3ACVE-2018-15919)|5.0Remotely observable behaviour in auth-gss2.c in OpenSSH through 7.8 could be used by remote attackers to detect existence of users on a target system when GSS2 is in use. NOTE: the discoverer states 'We understand that the OpenSSH developers do not want to treat such a username enumeration (or "oracle") as a vulnerability.'|
|[CVE-2018-15473](https://www.shodan.io/search?query=vuln%3ACVE-2018-15473)|5.0OpenSSH through 7.7 is prone to a user enumeration vulnerability due to not delaying bailout for an invalid authenticating user until after the packet containing the request has been fully parsed, related to auth2-gss.c, auth2-hostbased.c, and auth2-pubkey.c.|
|[CVE-2017-15906](https://www.shodan.io/search?query=vuln%3ACVE-2017-15906)|5.0The process_open function in sftp-server.c in OpenSSH before 7.6 does not properly prevent write operations in readonly mode, which allows attackers to create zero-length files.|
|[CVE-2016-20012](https://www.shodan.io/search?query=vuln%3ACVE-2016-20012)|4.3** DISPUTED ** OpenSSH through 8.7 allows remote attackers, who have a suspicion that a certain combination of username and public key is known to an SSH server, to test whether this suspicion is correct. This occurs because a challenge is sent only when that combination could be valid for a login session. NOTE: the vendor does not recognize user enumeration as a vulnerability for this product.|

__________
# The Maltego












# Se encontraron unos documentos del sitio, nada importante

![[documentos .png \| 1000]]
# Se analizo el primer correo

[oscar@romeropineda.com](mailto:oscar@romeropineda.com)  
Se encontraron algunas ubicaciones relacionadas a el así como unas imágenes en ruso nada relevantes, el dominio al que pertenecía y otros dominio que manda a un servidor apache 

![correo 1.png](/img/user/correo%201.png)

[https://romeropineda.net/"](https://romeropineda.net/%22)


![Pasted image 20240207151115.png](/img/user/Pasted%20image%2020240207151115.png)
# Se analizo el segundo correo.

Se encontró al dominio que pertenece con algunas imágenes relacionadas pero anda relevantes.  
[mvillegas@solucionesroots.com](mailto:mvillegas@solucionesroots.com)

![correo 2.png](/img/user/correo%202.png)

Estructura del hosting de la IP 162.240.71.37![Estructura del hostin .png](/img/user/Estructura%20del%20hostin%20.png)